---
title: Examples
description: "Practical examples for Excel-Claude Integration"
---

## Overview

This page provides practical, real-world examples of using the Excel-Claude Integration. Each example includes complete code samples and explanations.

## Quick Start Examples

### Example 1: Analyze Sales Data

Ask Claude to analyze sales trends from an Excel workbook.

<CodeGroup>
```javascript JavaScript
import { ExcelClaudeClient } from '@your-org/excel-claude-sdk';

const client = new ExcelClaudeClient({
  accessToken: process.env.ACCESS_TOKEN,
});

async function analyzeSales() {
  const result = await client.query({
    workbookId: 'YOUR_WORKBOOK_ID',
    worksheet: 'Sales Data',
    query: 'What are the top 3 products by revenue in Q4?',
    includeCharts: true,
  });

  console.log('Answer:', result.answer);
  console.log('Data:', result.data);

  if (result.chart) {
    console.log('Suggested chart:', result.chart.type);
  }
}

analyzeSales();
```

```python Python
from excel_claude import ExcelClaudeClient

client = ExcelClaudeClient(access_token=os.environ['ACCESS_TOKEN'])

def analyze_sales():
    result = client.query(
        workbook_id='YOUR_WORKBOOK_ID',
        worksheet='Sales Data',
        query='What are the top 3 products by revenue in Q4?',
        include_charts=True
    )

    print(f"Answer: {result['answer']}")
    print(f"Data: {result['data']}")

    if result.get('chart'):
        print(f"Suggested chart: {result['chart']['type']}")

analyze_sales()
```

```typescript TypeScript
import { ExcelClaudeClient, QueryResult } from '@your-org/excel-claude-sdk';

const client = new ExcelClaudeClient({
  accessToken: process.env.ACCESS_TOKEN!,
});

async function analyzeSales(): Promise<void> {
  const result: QueryResult = await client.query({
    workbookId: 'YOUR_WORKBOOK_ID',
    worksheet: 'Sales Data',
    query: 'What are the top 3 products by revenue in Q4?',
    includeCharts: true,
  });

  console.log('Answer:', result.answer);
  console.log('Top products:', result.data.products);

  if (result.chart) {
    console.log(`Create a ${result.chart.type} chart`);
  }
}

analyzeSales().catch(console.error);
```
</CodeGroup>

**Output:**
```json
{
  "answer": "The top 3 products by Q4 revenue are: 1) Premium Widget ($450K), 2) Deluxe Gadget ($380K), and 3) Standard Tool ($290K). Premium Widget increased 23% from Q3.",
  "data": {
    "products": [
      { "name": "Premium Widget", "revenue": 450000, "growth": 0.23 },
      { "name": "Deluxe Gadget", "revenue": 380000, "growth": 0.15 },
      { "name": "Standard Tool", "revenue": 290000, "growth": 0.08 }
    ]
  },
  "chart": {
    "type": "bar",
    "title": "Top Products by Q4 Revenue",
    "data": "products"
  }
}
```

---

### Example 2: Generate Complex Formula

Generate Excel formulas from natural language descriptions.

<CodeGroup>
```javascript JavaScript
async function generateFormula() {
  const result = await client.generateFormula({
    workbookId: 'YOUR_WORKBOOK_ID',
    description: 'Calculate the weighted average of column C using column B as weights, but only for rows where column A contains "Active"',
    targetCell: 'E2',
    applyFormula: false, // Preview only
  });

  console.log('Formula:', result.formula);
  console.log('Explanation:', result.explanation);
  console.log('Expected result:', result.result);

  // Apply the formula if it looks correct
  if (confirm('Apply this formula?')) {
    await client.applyFormula({
      workbookId: 'YOUR_WORKBOOK_ID',
      cell: 'E2',
      formula: result.formula,
    });
  }
}
```

```python Python
def generate_formula():
    result = client.generate_formula(
        workbook_id='YOUR_WORKBOOK_ID',
        description='Calculate the weighted average of column C using column B as weights, but only for rows where column A contains "Active"',
        target_cell='E2',
        apply_formula=False  # Preview only
    )

    print(f"Formula: {result['formula']}")
    print(f"Explanation: {result['explanation']}")
    print(f"Expected result: {result['result']}")

    # Apply the formula if it looks correct
    if input('Apply this formula? (y/n): ').lower() == 'y':
        client.apply_formula(
            workbook_id='YOUR_WORKBOOK_ID',
            cell='E2',
            formula=result['formula']
        )
```
</CodeGroup>

**Output:**
```json
{
  "formula": "=SUMPRODUCT((A:A=\"Active\")*(B:B)*(C:C))/SUMIF(A:A,\"Active\",B:B)",
  "explanation": "This formula calculates a weighted average by: 1) Filtering rows where column A is 'Active', 2) Multiplying weights (column B) by values (column C), 3) Dividing by the sum of weights for 'Active' rows.",
  "result": 87.34
}
```

---

### Example 3: Data Cleaning

Clean and standardize messy data.

<CodeGroup>
```javascript JavaScript
async function cleanData() {
  const result = await client.transformData({
    workbookId: 'YOUR_WORKBOOK_ID',
    worksheet: 'Customer Data',
    range: 'A1:D500',
    transformation: `
      1. Remove duplicate entries based on email
      2. Standardize phone numbers to (XXX) XXX-XXXX format
      3. Convert all dates to YYYY-MM-DD format
      4. Capitalize first letter of first and last names
      5. Remove any rows with missing required fields
    `,
    preview: true,
  });

  console.log(`Changes preview:`);
  console.log(`- Duplicates removed: ${result.changes.duplicatesRemoved}`);
  console.log(`- Cells modified: ${result.changes.cellsModified}`);
  console.log(`- Errors found: ${result.changes.errors.length}`);

  // Show sample of cleaned data
  console.log('Sample cleaned data:');
  console.table(result.preview.slice(0, 5));

  // Apply if satisfied
  if (confirm('Apply these changes?')) {
    const applied = await client.transformData({
      ...result,
      preview: false,
    });
    console.log('Data cleaned successfully!');
  }
}
```

```python Python
def clean_data():
    result = client.transform_data(
        workbook_id='YOUR_WORKBOOK_ID',
        worksheet='Customer Data',
        range='A1:D500',
        transformation="""
            1. Remove duplicate entries based on email
            2. Standardize phone numbers to (XXX) XXX-XXXX format
            3. Convert all dates to YYYY-MM-DD format
            4. Capitalize first letter of first and last names
            5. Remove any rows with missing required fields
        """,
        preview=True
    )

    print("Changes preview:")
    print(f"- Duplicates removed: {result['changes']['duplicatesRemoved']}")
    print(f"- Cells modified: {result['changes']['cellsModified']}")
    print(f"- Errors found: {len(result['changes']['errors'])}")

    # Show sample of cleaned data
    print("\nSample cleaned data:")
    for row in result['preview'][:5]:
        print(row)

    # Apply if satisfied
    if input('Apply these changes? (y/n): ').lower() == 'y':
        applied = client.transform_data(
            workbook_id='YOUR_WORKBOOK_ID',
            worksheet='Customer Data',
            range='A1:D500',
            transformation=result['transformation'],
            preview=False
        )
        print('Data cleaned successfully!')
```
</CodeGroup>

**Output:**
```
Changes preview:
- Duplicates removed: 23
- Cells modified: 147
- Errors found: 0

Sample cleaned data:
┌─────────────┬────────────────┬──────────────────┬────────────┐
│ First Name  │ Last Name      │ Phone            │ Date       │
├─────────────┼────────────────┼──────────────────┼────────────┤
│ John        │ Smith          │ (555) 123-4567   │ 2024-01-15 │
│ Sarah       │ Johnson        │ (555) 234-5678   │ 2024-02-20 │
│ Michael     │ Williams       │ (555) 345-6789   │ 2024-03-10 │
└─────────────┴────────────────┴──────────────────┴────────────┘
```

---

## Advanced Examples

### Example 4: Batch Processing Multiple Workbooks

Process multiple Excel files in parallel.

<CodeGroup>
```javascript JavaScript
import pLimit from 'p-limit';

async function batchAnalysis() {
  const workbookIds = [
    'workbook1_id',
    'workbook2_id',
    'workbook3_id',
    'workbook4_id',
  ];

  // Limit concurrent requests to avoid rate limits
  const limit = pLimit(3);

  const analyses = await Promise.all(
    workbookIds.map((id) =>
      limit(async () => {
        try {
          return await client.query({
            workbookId: id,
            query: 'Summarize total revenue and profit margin',
          });
        } catch (error) {
          console.error(`Error processing ${id}:`, error);
          return null;
        }
      })
    )
  );

  // Aggregate results
  const summary = analyses
    .filter((result) => result !== null)
    .map((result, index) => ({
      workbook: workbookIds[index],
      answer: result.answer,
      revenue: result.data.revenue,
      margin: result.data.margin,
    }));

  console.table(summary);
}

batchAnalysis();
```

```python Python
import asyncio
from excel_claude import AsyncExcelClaudeClient

async def batch_analysis():
    client = AsyncExcelClaudeClient(access_token=os.environ['ACCESS_TOKEN'])

    workbook_ids = [
        'workbook1_id',
        'workbook2_id',
        'workbook3_id',
        'workbook4_id',
    ]

    async def analyze_workbook(workbook_id):
        try:
            return await client.query(
                workbook_id=workbook_id,
                query='Summarize total revenue and profit margin'
            )
        except Exception as e:
            print(f"Error processing {workbook_id}: {e}")
            return None

    # Process with controlled concurrency
    semaphore = asyncio.Semaphore(3)

    async def limited_analyze(workbook_id):
        async with semaphore:
            return await analyze_workbook(workbook_id)

    analyses = await asyncio.gather(*[
        limited_analyze(wid) for wid in workbook_ids
    ])

    # Aggregate results
    summary = [
        {
            'workbook': workbook_ids[i],
            'revenue': result['data']['revenue'],
            'margin': result['data']['margin']
        }
        for i, result in enumerate(analyses)
        if result is not None
    ]

    print(summary)

asyncio.run(batch_analysis())
```
</CodeGroup>

---

### Example 5: Real-time Collaboration with Webhooks

Monitor changes to a workbook in real-time.

<CodeGroup>
```javascript Express.js Webhook Server
import express from 'express';
import crypto from 'crypto';

const app = express();
app.use(express.json());

// Webhook endpoint
app.post('/webhook/excel-changes', (req, res) => {
  // Verify webhook signature
  const signature = req.headers['x-webhook-signature'];
  const secret = process.env.WEBHOOK_SECRET;

  const expectedSignature = crypto
    .createHmac('sha256', secret)
    .update(JSON.stringify(req.body))
    .digest('hex');

  if (signature !== expectedSignature) {
    return res.status(401).send('Invalid signature');
  }

  // Process the change event
  const { event, workbookId, worksheet, range, user } = req.body;

  console.log(`Change detected:`);
  console.log(`- Event: ${event}`);
  console.log(`- Workbook: ${workbookId}`);
  console.log(`- Worksheet: ${worksheet}`);
  console.log(`- Range: ${range}`);
  console.log(`- User: ${user.email}`);

  // Trigger Claude analysis on the changed data
  if (event === 'data.changed') {
    analyzeChanges(workbookId, worksheet, range);
  }

  res.status(200).send('OK');
});

async function analyzeChanges(workbookId, worksheet, range) {
  const result = await client.query({
    workbookId,
    worksheet,
    query: `Analyze the data in ${range} for anomalies or interesting patterns`,
  });

  if (result.data.anomalies?.length > 0) {
    // Send alert
    console.log('⚠️  Anomalies detected:', result.data.anomalies);
    await sendAlert(result.data.anomalies);
  }
}

app.listen(3000, () => {
  console.log('Webhook server running on port 3000');
});
```

```python Flask Webhook Server
from flask import Flask, request, jsonify
import hmac
import hashlib
import os

app = Flask(__name__)

@app.route('/webhook/excel-changes', methods=['POST'])
def webhook():
    # Verify webhook signature
    signature = request.headers.get('X-Webhook-Signature')
    secret = os.environ['WEBHOOK_SECRET'].encode()

    expected_signature = hmac.new(
        secret,
        request.get_data(),
        hashlib.sha256
    ).hexdigest()

    if signature != expected_signature:
        return 'Invalid signature', 401

    # Process the change event
    data = request.json
    event = data['event']
    workbook_id = data['workbookId']
    worksheet = data['worksheet']
    range_str = data['range']
    user = data['user']

    print(f"Change detected:")
    print(f"- Event: {event}")
    print(f"- Workbook: {workbook_id}")
    print(f"- Worksheet: {worksheet}")
    print(f"- Range: {range_str}")
    print(f"- User: {user['email']}")

    # Trigger Claude analysis on the changed data
    if event == 'data.changed':
        analyze_changes(workbook_id, worksheet, range_str)

    return 'OK', 200

def analyze_changes(workbook_id, worksheet, range_str):
    result = client.query(
        workbook_id=workbook_id,
        worksheet=worksheet,
        query=f"Analyze the data in {range_str} for anomalies or interesting patterns"
    )

    if result.get('data', {}).get('anomalies'):
        # Send alert
        print(f"⚠️  Anomalies detected: {result['data']['anomalies']}")
        send_alert(result['data']['anomalies'])

if __name__ == '__main__':
    app.run(port=3000)
```
</CodeGroup>

---

### Example 6: Custom Excel Add-in

Build an Excel add-in with Claude integration.

<CodeGroup>
```javascript Excel Add-in (Office.js)
// taskpane.js
Office.onReady((info) => {
  if (info.host === Office.HostType.Excel) {
    document.getElementById('analyze-button').onclick = analyzeSelection;
  }
});

async function analyzeSelection() {
  try {
    await Excel.run(async (context) => {
      const range = context.workbook.getSelectedRange();
      range.load('address, values');
      await context.sync();

      // Send data to Claude via your backend
      const response = await fetch('https://your-api.com/analyze', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${getAccessToken()}`,
        },
        body: JSON.stringify({
          range: range.address,
          values: range.values,
          query: document.getElementById('query-input').value,
        }),
      });

      const result = await response.json();

      // Display result in task pane
      document.getElementById('result').innerHTML = `
        <h3>Analysis Result</h3>
        <p>${result.answer}</p>
        ${result.formula ? `<code>${result.formula}</code>` : ''}
      `;

      // Optionally insert formula
      if (result.formula && confirm('Insert this formula?')) {
        const formulaCell = range.getCell(0, range.columnCount);
        formulaCell.formulas = [[result.formula]];
        await context.sync();
      }
    });
  } catch (error) {
    console.error('Error:', error);
    showError(error.message);
  }
}
```

```html Add-in UI (taskpane.html)
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Claude for Excel</title>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script src="taskpane.js"></script>
    <style>
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        padding: 20px;
      }
      input,
      button {
        width: 100%;
        padding: 10px;
        margin: 10px 0;
      }
      #result {
        margin-top: 20px;
        padding: 15px;
        background: #f0f0f0;
        border-radius: 5px;
      }
    </style>
  </head>
  <body>
    <h2>Claude for Excel</h2>

    <p>Select data in your spreadsheet and ask Claude to analyze it:</p>

    <input
      type="text"
      id="query-input"
      placeholder="What insights can you provide about this data?"
    />

    <button id="analyze-button">Analyze with Claude</button>

    <div id="result"></div>
  </body>
</html>
```
</CodeGroup>

---

### Example 7: Automated Report Generation

Generate comprehensive reports from Excel data.

<CodeGroup>
```javascript JavaScript
async function generateReport(workbookId) {
  // 1. Get data insights
  const insights = await client.query({
    workbookId,
    query: `
      Analyze this financial data and provide:
      1. Key performance indicators
      2. Trends and patterns
      3. Areas of concern
      4. Recommendations
    `,
  });

  // 2. Generate visualizations
  const charts = await Promise.all(
    insights.data.metrics.map((metric) =>
      client.generateChart({
        workbookId,
        metric: metric.name,
        type: 'line',
      })
    )
  );

  // 3. Create summary worksheet
  await client.createWorksheet({
    workbookId,
    name: 'Executive Summary',
    content: {
      title: 'Financial Report - Q4 2024',
      sections: [
        {
          heading: 'Key Metrics',
          data: insights.data.kpis,
        },
        {
          heading: 'Analysis',
          text: insights.answer,
        },
        {
          heading: 'Visualizations',
          charts: charts,
        },
      ],
    },
  });

  console.log('Report generated successfully!');
  return {
    summary: insights.answer,
    worksheetName: 'Executive Summary',
  };
}

// Usage
generateReport('YOUR_WORKBOOK_ID').then((report) => {
  console.log('Report:', report.summary);
});
```

```python Python
def generate_report(workbook_id):
    # 1. Get data insights
    insights = client.query(
        workbook_id=workbook_id,
        query="""
            Analyze this financial data and provide:
            1. Key performance indicators
            2. Trends and patterns
            3. Areas of concern
            4. Recommendations
        """
    )

    # 2. Generate visualizations
    charts = []
    for metric in insights['data']['metrics']:
        chart = client.generate_chart(
            workbook_id=workbook_id,
            metric=metric['name'],
            chart_type='line'
        )
        charts.append(chart)

    # 3. Create summary worksheet
    client.create_worksheet(
        workbook_id=workbook_id,
        name='Executive Summary',
        content={
            'title': 'Financial Report - Q4 2024',
            'sections': [
                {
                    'heading': 'Key Metrics',
                    'data': insights['data']['kpis']
                },
                {
                    'heading': 'Analysis',
                    'text': insights['answer']
                },
                {
                    'heading': 'Visualizations',
                    'charts': charts
                }
            ]
        }
    )

    print('Report generated successfully!')
    return {
        'summary': insights['answer'],
        'worksheet_name': 'Executive Summary'
    }

# Usage
report = generate_report('YOUR_WORKBOOK_ID')
print(f"Report: {report['summary']}")
```
</CodeGroup>

---

## Example Use Cases

### Finance & Accounting

<AccordionGroup>
  <Accordion title="Budget Analysis" icon="sack-dollar">
    ```javascript
    const result = await client.query({
      workbookId: 'budget_2024',
      query: 'Compare actual vs budgeted expenses by department and flag variances over 10%',
    });
    ```
  </Accordion>

  <Accordion title="Financial Forecasting" icon="chart-line">
    ```javascript
    const forecast = await client.query({
      workbookId: 'revenue_data',
      query: 'Based on the last 12 months, project revenue for next quarter with confidence intervals',
    });
    ```
  </Accordion>

  <Accordion title="Expense Categorization" icon="tags">
    ```javascript
    const categorized = await client.transformData({
      workbookId: 'expenses',
      range: 'A1:C500',
      transformation: 'Automatically categorize expenses in column B based on description in column A',
    });
    ```
  </Accordion>
</AccordionGroup>

### Sales & Marketing

<AccordionGroup>
  <Accordion title="Customer Segmentation" icon="users">
    ```javascript
    const segments = await client.query({
      workbookId: 'customer_data',
      query: 'Segment customers into groups based on purchase behavior and lifetime value',
    });
    ```
  </Accordion>

  <Accordion title="Campaign Performance" icon="bullhorn">
    ```javascript
    const performance = await client.query({
      workbookId: 'campaigns',
      query: 'Which marketing campaigns had the best ROI? What characteristics do they share?',
    });
    ```
  </Accordion>

  <Accordion title="Lead Scoring" icon="ranking-star">
    ```javascript
    const formula = await client.generateFormula({
      workbookId: 'leads',
      description: 'Calculate lead score based on company size, engagement level, and budget',
    });
    ```
  </Accordion>
</AccordionGroup>

### Operations

<AccordionGroup>
  <Accordion title="Inventory Optimization" icon="boxes-stacked">
    ```javascript
    const optimization = await client.query({
      workbookId: 'inventory',
      query: 'Identify slow-moving items and recommend optimal reorder points',
    });
    ```
  </Accordion>

  <Accordion title="Quality Control" icon="badge-check">
    ```javascript
    const issues = await client.query({
      workbookId: 'production_logs',
      query: 'Identify patterns in quality control failures and suggest root causes',
    });
    ```
  </Accordion>

  <Accordion title="Schedule Optimization" icon="calendar">
    ```javascript
    const schedule = await client.query({
      workbookId: 'employee_schedule',
      query: 'Optimize shift assignments to minimize overtime while ensuring adequate coverage',
    });
    ```
  </Accordion>
</AccordionGroup>

## Best Practices

<CardGroup cols={2}>
  <Card title="Efficient Queries" icon="bolt">
    - Be specific in your queries
    - Specify worksheet names
    - Limit data ranges when possible
    - Cache frequently accessed results
  </Card>

  <Card title="Error Handling" icon="shield-check">
    - Always wrap API calls in try-catch
    - Implement exponential backoff
    - Handle rate limits gracefully
    - Log errors for debugging
  </Card>

  <Card title="Data Privacy" icon="lock">
    - Don't log sensitive data
    - Use environment variables for tokens
    - Implement proper access controls
    - Audit API usage regularly
  </Card>

  <Card title="Performance" icon="gauge-high">
    - Batch requests when possible
    - Use webhooks for real-time updates
    - Implement client-side caching
    - Monitor API usage and costs
  </Card>
</CardGroup>

## Testing

### Unit Tests Example

<CodeGroup>
```javascript Jest
import { ExcelClaudeClient } from '@your-org/excel-claude-sdk';

jest.mock('@your-org/excel-claude-sdk');

describe('Excel-Claude Integration', () => {
  let client;

  beforeEach(() => {
    client = new ExcelClaudeClient({ accessToken: 'test_token' });
  });

  test('should analyze sales data', async () => {
    const mockResponse = {
      answer: 'Total revenue is $1.2M',
      data: { revenue: 1200000 },
    };

    client.query.mockResolvedValue(mockResponse);

    const result = await client.query({
      workbookId: 'test_id',
      query: 'What is the total revenue?',
    });

    expect(result.answer).toContain('$1.2M');
    expect(result.data.revenue).toBe(1200000);
  });

  test('should handle API errors', async () => {
    client.query.mockRejectedValue(new Error('API Error'));

    await expect(
      client.query({
        workbookId: 'invalid_id',
        query: 'test',
      })
    ).rejects.toThrow('API Error');
  });
});
```

```python Pytest
import pytest
from excel_claude import ExcelClaudeClient
from unittest.mock import Mock, patch

@pytest.fixture
def client():
    return ExcelClaudeClient(access_token='test_token')

def test_analyze_sales_data(client):
    mock_response = {
        'answer': 'Total revenue is $1.2M',
        'data': {'revenue': 1200000}
    }

    with patch.object(client, 'query', return_value=mock_response):
        result = client.query(
            workbook_id='test_id',
            query='What is the total revenue?'
        )

        assert '$1.2M' in result['answer']
        assert result['data']['revenue'] == 1200000

def test_handle_api_errors(client):
    with patch.object(client, 'query', side_effect=Exception('API Error')):
        with pytest.raises(Exception, match='API Error'):
            client.query(
                workbook_id='invalid_id',
                query='test'
            )
```
</CodeGroup>

## Resources

<CardGroup cols={2}>
  <Card title="Sample Repository" icon="github" href="https://github.com/your-org/excel-claude-examples">
    Complete code examples on GitHub
  </Card>

  <Card title="API Reference" icon="code" href="/excel-claude-api">
    Detailed API documentation
  </Card>

  <Card title="Video Tutorials" icon="video" href="https://youtube.com/@your-channel">
    Step-by-step video guides
  </Card>

  <Card title="Community Forum" icon="comments" href="https://community.your-domain.com">
    Get help from the community
  </Card>
</CardGroup>

## Next Steps

Ready to start building? Here are some suggestions:

1. **Start Simple**: Begin with basic queries on a test workbook
2. **Explore Examples**: Try modifying the examples above for your use case
3. **Build Incrementally**: Add features one at a time
4. **Share Your Work**: Contribute examples back to the community

<Card title="Need Help?" icon="question">
  If you have questions or run into issues, check out:
  - [Architecture docs](/excel-architecture) for technical details
  - [API reference](/excel-claude-api) for endpoint documentation
  - [OneDrive setup](/excel-onedrive-setup) for configuration help
</Card>
